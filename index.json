[{"categories":["RedTeam"],"content":"Shellcode Loader，免杀360进程注入+内存扫描Demo","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":["RedTeam"],"content":"概述 免杀Demo。实现360静动态、行为(进程注入)，及常见内存扫描Bypass。 两大痛点 动态和静态还是很容易过的，但是360环境下的进程注入，还有高度防护环境下的内存扫描，如果不注意还是很容易被检测到的。 免杀效果 行为查杀Bypass 360的行为查杀 (进程注入) 还是很大的痛点，CS后渗透任务常用命令基本都依赖fork\u0026run，起一个子进程然后注入。而360对进程注入杀的特别死，基于白名单机制，只要不是白名单进程就会告警。所以Bypass方案就变成了上线为白名单进程即可Bypass，而notepad就是白名单进程。 经过测试，远程线程劫持可以实现上线到白名单进程，且不会被查杀。 内存扫描Bypass 针对的内存扫描工具： BeaconEye Hunt-Sleeping-Beacons pe-sieve moneta MalMemDetect Yara 主要思路包括：CS自带的内存规避相关机制，静态特征修改、变异的sleepmask、beacon patch、开源UDRL。 ","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/:0:0","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":["RedTeam"],"content":"一、模式匹配Bypass ","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/:1:0","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":["RedTeam"],"content":"1. Yara Malleable C2进行特征替换 ","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/:1:1","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":["RedTeam"],"content":"2. BeaconEye 使用的开源UDRL，Beacon休眠时可以过BeaconEye，但执行post-ex任务还是会被检测。 BeaconEye Bypass方法用的是网上常用的Gap字节填充，对beacon.dll进行Patch e.g ","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/:1:2","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":["RedTeam"],"content":"二、异常内存属性检测Bypass 使用开源UDRL，原理深入学习中 项目地址：https://github.com/kyleavery/AceLdr e.g ","date":"2020-10-01","objectID":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/:2:0","tags":["RedTeam","免杀","C2"],"title":"ShellcodeLoader免杀360注入+内存扫描","uri":"/posts/shellcodeloader%E5%85%8D%E6%9D%80360%E5%8F%8A%E5%86%85%E5%AD%98%E6%89%AB%E6%8F%8F/"},{"categories":null,"content":"About Me","date":"2025-10-01","objectID":"/about/","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"关于博客 个人博客，链接社区 分享和交流很重要 ","date":"2025-10-01","objectID":"/about/:1:0","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"About Me 💻 红队选手、安全爱好者, 向往成为独立安全研究员 🛠️ 热衷于探索底层原理 🏔️ 爱好户外、摄影, 技术宅\u0026户外野驴并存 💪 空杯心态，一直在路上 ","date":"2025-10-01","objectID":"/about/:2:0","tags":null,"title":"","uri":"/about/"}]